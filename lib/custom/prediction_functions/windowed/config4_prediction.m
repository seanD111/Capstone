function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 23-Apr-2016 01:13:28.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 66xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 34xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-194.809818048627;-48.2639223160219;-49.8794715674687;-62.1181202841069;-56.0500247900266;-58.3312774442508;-50.8079516376832;-62.1666329648877;-57.910074656537;-57.6364205446867;-74.1943837308711;-57.8592235933495;-60.3844813087239;-2073.95719228195;-564.794115960759;-588.707338688689;-490.099756582186;-559.02228571724;-541.112556676474;-586.651801783497;-539.54713300912;-550.66217422308;-508.390575769942;-601.948227046953;-525.601591176444;-608.04515600357;-2049.49585417644;-788.479709462832;-696.966234359947;-538.248920590633;-608.219719170257;-706.566421616812;-666.653922130718;-697.106826959985;-914.213373502405;-730.038221360122;-709.083713456163;-675.137103177882;-736.073791591679;-4.52609465245823;-1.70687731934907;-1.46528362469888;-1.28616788914202;-1.35351870986255;-1.02901342562756;-1.11402979770072;-0.964210031527095;-0.9084520111693;-46.0757157370272;-13.4731638244293;-13.5172918423788;-15.1346317009343;-11.1979090086175;-10.8598604109445;-11.7728257657672;-10.7627698886042;-9.01696965822029;-37.0473572674577;-12.3275756612168;-13.3808158208099;-13.8647121258435;-13.0747830611784;-10.575234850354;-12.0335608115133;-13.6189819148059;-9.19817712103004];
x1_step1.gain = [0.00590316852916103;0.0187724913314111;0.0172463996718647;0.0180040697613851;0.0179550381651254;0.017675166930894;0.0186213281462868;0.0174004348384678;0.0151521432824578;0.0184814009289804;0.0152051215100378;0.0178909655508213;0.0166975812034228;0.000433774863447308;0.00206144268625784;0.00178711340850774;0.00201188571887463;0.00196819220234821;0.00196202257440427;0.00174223847761528;0.00174855163915173;0.00175177430849412;0.00177902060725957;0.00157077745815597;0.00177087421551218;0.00168151102855393;0.000497988193673982;0.00152834691987226;0.00164793782486036;0.00167017676575369;0.00182591051140781;0.0016079944751888;0.0015399814986461;0.00141027420969196;0.0012822205481645;0.00147122580659939;0.00142875122653354;0.00154078899402617;0.00139491206364102;0.245056921682405;0.732359018981301;0.826761962454174;0.830236756825633;0.947126086131905;1.11807625819619;1.04811930966153;1.03755326237053;1.19582093322106;0.0210940436044202;0.0685268670929129;0.0777743608838211;0.069396127737114;0.0817318812066388;0.092190848643746;0.0890369311843295;0.0955492115276294;0.122789432192883;0.0238685389503581;0.0761219474428022;0.0735253158624823;0.0756515118505354;0.079172958416038;0.0900085623368909;0.0837870512060115;0.0796064824534889;0.104861860590133];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.4712187796111182;-0.61689289430334959;1.3154263512538735;0.76489280244887226;-2.2743907649272623;1.0419557802987032;-4.8618443672730196;-1.0413579207943906;2.7772985653053985;3.2121650503595287];
IW1_1 = [1.5091232156307861 -0.77235220354357326 -1.7736097296007429 0.43771844752539901 -0.2651998074420287 0.95826045591608189 -0.12015590587547498 -0.51782962732280102 -0.20673033615695982 -0.27477172544632639 0.11754835412692921 -0.0014765795143110547 0.26082964753463245 -2.8741365282263764 -0.42412145518388356 0.19999527836088404 -0.090227661633188891 0.044366496005699085 0.10668175577680011 0.063667726172456196 0.065842477102151575 0.072069853732696393 -0.060923040808385662 0.01100312319157911 -0.072035807664366014 -0.030034184385196377 1.1752759350320667 -0.41753693027013933 -0.91569266435517693 0.19379927201014591 -0.083324076198349736 0.53962264485343614 -0.09794541691488716 -0.31548123244759219 -0.1272370926128078 -0.19321231445711898 0.044320089144060014 -0.026480335465863307 0.16505065228098198 -1.0026952509925655 0.065389388350938354 0.19723669811955039 0.12877336738498005 -0.33308669996705875 -0.061630411229817335 0.38019136852986268 -0.32238190515071924 0.19553859696293599 0.77292350832101508 0.36922169582431841 -0.26878523281629063 -0.3189606878279112 -0.21504817418061828 0.13984354670162449 0.059983693530659223 -0.12280746030761462 -0.05749205042676294 -0.099149210545350669 0.10585931978296174 0.018395777548046464 -0.070878842398561348 -0.21592183392786718 -0.0038455923358122535 0.26371844189546123 -0.3153420508774013 0.097784090850267902;0.70163906614305638 0.36043215724958932 -0.29705470263955569 -3.3358609063979823 -0.71178354668153432 -0.11416329819936495 -0.22426950659527514 0.66553267305737362 0.27977295995832335 0.82877064310614135 1.0478039670697152 0.88221177262240225 0.20477137387835759 9.1981045187570807 1.3091099926240717 0.64664038421649195 -0.61289424890037958 -0.11987866442298054 0.12109060757372986 -0.084140561807150502 -0.043141229549750915 -0.029921887092354535 0.12513373033074424 0.065824038829434564 0.13704888922317543 0.087980313518550624 -0.62774666879939411 0.083839485731532132 -0.3575848423186791 -1.5914679321536578 -0.24629887914313603 -0.038469965358085528 -0.079532363865706612 0.34102458029973698 0.14945956126835297 0.47868508115419878 0.57097584106805177 0.52835688551575866 0.10742771903457757 1.0711235764909897 0.25233427981844231 1.0821965083059928 2.0402470120734804 1.3339222858895345 0.039249873632669297 -1.8661967022167971 0.46760706747088265 -1.6307079310363191 -3.4062491282963596 -0.58851301808334733 0.12907991438603275 0.47208595842204504 0.40898486620819208 0.34569326268942052 -0.16516246650908564 0.073378298517741844 -0.21336863869301795 -0.69085827464854022 -0.13005872280541902 0.60255916300492718 1.3491614977488642 0.90079640187146515 0.11399594931871176 -1.3171719059134712 0.32969161951225895 -0.93865486764797001;-3.2301321490730888 4.164933945647193 -1.4735157019598404 1.96380416589483 -2.2146424778803988 1.1216222153866535 -1.2269398950351984 0.95127279262868225 0.11779481243737444 0.52130776390446998 0.28349833951344178 0.27205449811373889 0.14256150274429061 -0.10775437148388836 0.19989966346392449 -0.011563311752744025 -0.10396801955061197 -0.051869570769220129 -0.011894781640692487 0.070706537117883342 0.012787882580210373 0.053052446341190648 0.02469226982736027 0.0041651954148457428 0.053580215527302313 0.017446414813760878 -1.1776992403663109 2.4175483294891196 -0.73295446388056917 1.1413922488180204 -1.0714728307248604 0.70611211950369079 -0.75494589160805048 0.66133935183010706 0.16212777794964767 0.34276465576605852 0.21975457012051627 0.18381893675275121 0.11223554503298944 1.1882830337627492 -1.7662870562960686 -1.1939410858337778 0.42908239896755684 0.29660602036275519 -0.51496508935776197 0.33970590146571211 0.27085751964604649 -0.49338139982812734 -0.061525749312444825 0.016735274884937736 -0.078376131161818588 0.030804388536915715 -0.07817982760973026 0.1293635803649352 -0.022639095506698761 -0.032900162097147599 0.0018357596107617374 0.31449387795315398 -0.80660996644098037 -0.62384931419528911 0.18809848933048298 0.075616076479356975 -0.30944096347722394 0.13114010579602542 0.10158816565297393 -0.28544889163215231;1.8749930786298517 -1.3535893940285963 -1.0304539194715565 2.315001939573532 -1.3666329817343581 0.45922756334637327 1.4978612005515792 0.25588654177783288 -0.39529266907398591 -1.2009789231888413 -0.26784644254495144 -0.31253064354054894 0.067048912161470658 -0.59675579101551413 0.18463424065320716 -1.2512306040675778 1.2281466673680617 -0.15596877885651148 -0.72300712945512202 -0.125790853436266 -0.32379603575769694 0.095081404338652017 -0.23992769445276066 -0.084845152972998522 -0.11884672039778253 0.29498929879276786 -0.10918619823565791 -0.32654935172738653 -0.21599362460724761 1.0194192268319449 -1.0879825981543056 0.26648677840495999 1.0137925148977773 0.18466531556265176 -0.42633303771804493 -0.8197840971717999 -0.10706911333081102 -0.24118074475545859 0.083262614080991545 -1.2465127155385156 -0.40932230971555983 1.1405980933109556 1.0674995520714097 -0.84618340592542363 -1.6937956316804925 0.70133105220068914 1.7743638802511252 -0.68247617198908639 1.0733676658119546 -0.54118899849216873 0.549814312392783 0.48456162930174929 0.50986571643153611 -0.69741491688449464 0.50521607635062793 0.91713386443815925 0.73146650604309693 -0.77417150593606299 0.037814565451734998 0.13544264641174403 1.0808908197421345 -0.72196178074280792 -1.3492019160792852 0.65445029471015403 1.8885836764168886 -0.51128076111768084;5.4387438813389393 -6.8515216887205534 1.1168343647993053 -0.85089687612220044 -1.80710423468459 0.75870777170187764 -1.1030303740431331 -0.4385684783516331 -1.0748065663358812 -1.5652019376726696 -1.1454048448963581 -0.75899867939724819 -0.81430799152947742 -2.058761334809148 0.55877108273917464 0.35822872508936515 -0.15334483635825957 -0.27946697148199423 0.14103965327557555 -0.10734167752462849 -0.00032170426003430135 -0.31923806957346007 0.060338496644700354 -0.16208338774243686 -0.068521176870533981 -0.030615157421826286 1.450196239412503 -3.0372476818631942 0.2485442602252661 -0.3948549039769747 -0.90561255365657911 0.59220518829899949 -0.59551209481316081 -0.15933303926651082 -0.57545795384037657 -0.91227051504355849 -0.41046231189713517 -0.4042225858856483 -0.30538768902489516 11.279904658505702 -5.4928171714612635 7.0908788149493871 -3.8534358419744899 3.0499332070304224 -1.8877089841670645 2.9490015790219064 -0.60048302923583474 0.17608127351561512 -0.048190118516901553 0.78847881428656941 -0.56197175146953005 -0.014017036027495763 0.017018150048170186 0.13522351376484329 0.22905042923408409 -0.05847930379229397 0.12901880771738491 1.1264295026449822 0.24616412669338938 1.1387688694646338 -0.34019447935951846 0.40013049854219934 0.0042594763191112148 0.66162992622471739 0.44053166480804473 -0.55017506037908626;-0.0086943344002841649 -3.9743700677287355 -2.6995182843261381 0.12296145783536964 0.11146408453243478 0.90592958019451331 0.4200065905126743 -0.023658359291614015 1.3703152526679714 -0.60926164267844674 2.2577494235677484 0.55166212801766767 1.4698011109919462 -1.127079101666854 -0.34524394933397412 0.22132334742282986 -0.11292636651539008 -0.075609167654906273 0.08997644026907152 -0.0086447477093178158 0.025405129672145008 0.15901802211382349 -0.073917218509433794 0.13025059816383999 0.0087040230575193816 -0.01436741092731028 0.50710040791545352 -2.3479615654745829 -1.3789697969045733 0.19093918583880437 0.12973411526365694 0.46107245962400584 0.23050142362170276 -0.098405413219861501 0.78245029881910244 -0.5330972372633539 1.2010632598620059 0.23991974441076225 0.80257113502407151 -3.104841280741959 2.2771307039622117 0.80641087794712529 1.5339003319142563 -1.140909702657477 -0.58545818803545702 -0.89723389451762092 0.22345618280694293 -0.31900311266511072 -0.19689559300000173 0.31680676381682249 -0.38414752462796936 -0.01705556451794165 -0.13858679265185969 0.3084669615419644 0.0091375424580913463 0.040474264175873957 -0.14709788368464924 -1.3649537677176597 0.86688349373510176 0.41776506980139183 0.70812068161712172 -0.71756263879233528 -0.41396359159731866 -0.50739722317298031 0.084098980689437136 -0.25216790313780579;3.6682851769232663 -2.2708115808806659 -0.68942306670505726 5.1305373509159695 -1.051745488012086 0.89933994561051922 0.70789587009752464 1.5618198756349146 1.3830301270567644 0.67321623679732989 1.8226178986419512 -0.16091983282672073 1.3662339088568483 -3.8653833096559445 2.7180508124534262 4.976213978779036 -4.0627686378752239 -1.1253094049375543 1.519988018539886 -0.51663221679243532 0.36843447176318234 0.13174926444689888 -0.11952800133418313 0.35584486351978528 -0.10027508351075783 -0.15255379166416894 2.6807876466162872 -2.1072322649324255 -1.5291478895954238 3.2767753638120332 -0.24432528807740567 0.19272322134882081 0.37133659032564065 1.0219232749118596 0.92084055795419439 0.27374139548796139 1.1465653973615215 -0.14492144323020426 0.86761774395795643 1.3724491392823708 -1.0301132019401245 1.3271278499555281 -0.72983796210477625 0.41422916571766988 -0.91261473455675501 1.0151714457806029 1.5179457965224903 0.041828588062693198 -1.5374845188596393 0.93729481769727807 -3.5357475627883646 -0.95778175197302118 -0.92352397628503513 3.7049169010295224 0.053510434609997742 -1.4695831765119025 -1.7835681588438124 -1.5405291079985517 -0.029214694861763459 -0.84286543959954663 -0.59828023904553052 -0.18288759374504357 0.65314495196837263 0.21377745280743926 0.36852839303225271 -0.61431445348992419;2.8324399646040574 -3.1995749893846006 0.24926420536331406 1.1458931862983881 2.9189620004684174 1.5713017564052745 1.5545106330934755 0.47314610056139583 1.0716941520443168 -0.025167625376561836 0.82387939975127811 0.32894004045789027 0.5472449395594744 0.21728738276332699 -0.0018386717883468978 0.17076857993019201 -0.03055731811684937 -0.01102040535756286 0.030888241379970344 -0.09511465075280004 -0.032311069773691706 0.017810468833741332 -0.017846050546581737 0.051805400558528433 0.011347497508401664 -0.00059632792759479135 1.1898747403888126 -1.8973252475383846 0.0291890173441842 0.62940366520306334 1.3871198023528064 0.76910644213549406 0.91897027801385289 0.21778219317383846 0.55816151695145855 -0.066395792382220042 0.42528229465284773 0.16312673819068538 0.26725052811774364 -2.090747816584412 1.3664465067043698 0.31912215389109527 -0.21006828520356932 -1.8181924998817129 -0.89286458845485484 -1.4738870491858489 -0.25777360636055119 -0.3516263243438319 -0.19795110789338605 0.049826897901460526 -0.098293515430719972 0.061548516843979634 0.16585667207547553 0.14811341509825607 0.079207826653826641 0.070076296267571406 0.0066570178336297827 -0.91570034836341774 0.59819917258744315 0.13743685177052456 -0.045359811354481139 -0.98157585622240395 -0.52410769611869901 -0.81759653640943675 -0.074556240727223971 -0.22130673700863551;-6.5457609624594459 2.7161419315432758 0.4756024998595082 -1.2270957189224518 -1.5359029198823109 -0.5048721573281677 -1.2755244464385083 0.31486956431751062 -0.29511209868861787 -0.22311025915172752 -1.0168604936071275 -0.33832603555188118 -0.41010669892861173 -1.2660881775834651 0.01001370825857174 -0.47975276186153876 0.18557175818898677 0.060159762495607221 -0.028909969354081563 0.15802006934809873 0.065341182331939321 0.05532220586546055 0.034655453662669526 0.080821233574920173 0.15831690081599023 -0.045120754091689134 -2.1948432435670178 1.4433423516303319 0.33985941118205132 -0.55359456121162809 -0.73252173985499269 -0.22550562282773631 -0.78154512841496904 0.2604811776987504 -0.15463014287957294 -0.11126694914969196 -0.57434712886629957 -0.14895446093038558 -0.3221484740771085 1.5518890592280123 -0.44804018545329938 -0.94261040510362448 0.53651969510445352 0.97788107315426065 0.28791984179686164 0.50304586190818501 -0.12420690312395634 0.58120242694815405 0.72894479179122496 -0.093567595416012894 -0.040961979903527096 0.11118636668183442 -0.37712517136631485 -0.014907386427043586 -0.1526889234605884 -0.066111399915796315 -0.11231551269535091 0.99197107566393994 -0.35302453427747266 -0.18700660137369213 0.095218036295226877 0.46357314963237561 0.069923844412757882 0.25450178267235252 -0.26016488254336029 0.34237807099548728;-3.1526341537181395 -3.1050158834794557 -1.7577402835614193 -1.3444737210553102 -1.7324759331395121 -0.78237020626332276 -1.4959231316052002 -1.4514046735622002 -1.5528317048358351 -1.1105297047019977 -0.81085469272171073 -0.29221987484133322 -1.0260454560226604 2.8797863282503138 0.29551051856419364 -0.1072152855531554 0.61806656419203798 0.25377485078142392 -0.071693000281210728 0.18310895525344842 0.055367936203160731 0.0054899632311021223 0.031811156469520548 0.032899182580798408 0.0059313624509374115 0.050997535678383568 -2.2663998304981012 -1.8317806061890711 -0.85835429931478524 -0.71355675556535514 -0.84418301793510753 -0.3319216759547674 -0.86572868719980611 -0.90383296129221524 -0.93337028994989402 -0.69493973198780545 -0.45926927152222879 -0.15003991985686482 -0.60927443082389632 0.78493183205107797 0.98471086284442699 1.4462049040106657 0.82452659709325138 0.54947481728835568 0.7116962507907203 0.58254594615048216 0.4316952860856999 0.36980242610288366 -0.81885202187947559 -0.53595556965849156 0.11818376281782547 -0.018058515994396299 0.060657849727517761 -0.41892894775200978 -0.050333601118669878 0.17676955364050176 0.14916759526374063 -0.044301084889841087 0.33563618351670649 0.70254823395104826 0.48234963212315568 0.18894905080129587 0.30347734392129572 0.279189314773088 0.35809376280975974 0.22080629829285803];

% Layer 2
b2 = [-0.71244247658915005;-3.2354030579653332;-0.80808363357185287;-1.8353214210643121;1.4086400828959806;5.550539859438409;-0.43021033110209977;5.2627055103206972;-0.16133618297700214;-9.1939784004073495;-0.77564343003126501;3.0884963135588173;1.1640512880687377;1.7127157698783502;3.5255911805322011;-2.6037311246305168;-1.8370023914601938;3.3079345352944518;4.1854546475740593;0.21551996233129669;1.5361495821719944;2.6906225740192879;-0.3099949471511812;4.7749823084183509;2.2500189724793822;-3.1553857576009401;-6.5365916809579154;-0.2117092555229633;-3.8620333246601199;-0.43886244113582151;4.875675436713574;-4.7320395171873981;-1.7435231011964816;0.4721194199746187];
LW2_1 = [-1.1687369622661263 -0.69957280782119602 0.75483371703498692 -0.88141370526374629 -0.88186189486928002 0.0071595921850875922 -0.68961097038178765 -0.02388768539654575 -3.2438036108031678 -2.1211062266531444;-5.681522867015822 -1.2435313263233421 -1.8890705557252248 -2.2814845379676156 1.1486737281506907 2.1740544289845491 -1.839183064151219 5.0195205210756653 5.5555522012781129 -7.2238027070391668;-0.94239470913224876 0.55585091906512707 -0.24667047124743061 -1.7107171704014026 -0.37606751206378386 0.20070458051343121 0.69285568314070156 1.1414518985557662 0.86657842410552421 -3.5259960926920497;1.8393129348838166 1.178738351122685 -1.7434309823196552 -2.9875315346704303 -1.7787067656117719 5.5189625477637421 1.3011472986388855 -4.820018766352951 -2.3477663549158523 7.872294827040343;0.87371943337629343 -0.4550596722559323 0.18834510471927693 2.367041089081344 -1.2481110902466854 -2.7180507257947508 0.079133094701531501 1.5739500449369019 -0.038660876071666281 1.0902696751783343;6.0699241116684988 2.7778674460454815 -0.74533258384960044 5.3677480716756554 -1.971405760320329 -3.56810878385369 0.16653959195315685 0.73836752666070227 3.0683328401877681 -1.0252152848016218;0.86175213997622568 0.98219505322954515 -1.9934364226214258 0.91813092000578322 0.25416467881758098 1.1841897892351507 -2.0735744453383966 2.7410549577637027 3.6424875768103688 -3.1290808634613683;1.9828460358757318 0.83685658336957436 -2.4705145310140373 4.1912271551858531 -1.5679367535697968 -3.0301570855899382 0.86611003867667735 -1.6693191414743125 3.0731990267433384 0.13209927454013842;4.9890909449961294 0.11783395839271119 1.058785409069273 0.069794143074330725 -1.0150898984950176 -5.7926976110868527 0.88936913608230661 12.097731986340658 1.6081680181951639 2.2467378186065998;-15.822209976600268 -13.505985058842661 4.5376398124593731 -9.8972567960561975 -3.894124294932725 -0.065544873368056158 4.4554665199159196 -1.1406212712674573 -11.553025194535513 10.711520812600646;3.54534944207336 -0.13296049247282984 -0.88692462883634071 -0.83361395851523401 1.9466613509329007 1.0860745255605462 1.3057454333210818 -1.9153642475530297 -0.75098343842035142 -1.5284057708400967;3.3971773413609525 1.0620298543030797 0.56074096620816671 3.2641903590545081 -1.7427952269310685 -3.2885301239239348 0.90541688546576371 1.6644568333846506 1.5060400306841062 0.5948513049110512;-0.56424276540544904 -0.26179251365267348 -2.5922085685423255 1.1543160358831124 0.46226123609299896 2.2794867169654771 -0.15236076058401327 -5.1326710257400103 -1.3382788789764706 -2.2657441243152556;1.3739737481958205 -0.12776559878505453 -1.4010731832722958 2.2441075743427881 2.3047766385583328 0.3321628750316426 0.019709273377505328 -0.87644984410846083 3.3969609051620875 -0.73038565310630099;1.9710414609949336 3.0054731080834931 1.9108496842258313 4.3517420417347834 -2.4905148982864977 -1.8601417181963287 -0.34378139280689868 -2.4166725937254294 3.4117442762647974 -3.9630706776010345;1.4190702854265422 -0.32144507951288187 1.059958476422197 -2.7284118205589185 5.4615234677195348 2.0777405943886218 -0.27832455209927404 1.5995466594361878 0.42042764808319749 -1.5902416074344228;1.7978412392489416 1.0509858699105734 6.0739504487096703 -1.1353998822877374 2.1155292066840596 1.3401579340926431 -1.2624561805071 -0.631169157234169 -0.55586268820791673 1.0326925450934394;1.3221701035333273 0.4617144145889116 -1.4637367724137584 2.7190870811874008 -1.029918744095689 -1.6140255409702429 1.1388110719248379 -2.2880561753107038 -0.075564311640443443 -1.8224512213495019;0.84114433385691811 0.16673894698647496 -3.4131974460595425 2.451513457389932 -3.0874688359082842 -3.6728287989879815 2.3152713962728226 1.3059246705225283 2.9769017112108296 3.7798334292361551;1.6061086969966487 0.87019130521528376 -0.5048929646735214 0.098913390886818359 -0.25639127610439039 2.4441556621512239 -0.92192493276388154 -2.8666433369192603 -0.28620895770292687 0.64326945968458893;-1.5531525406080777 -0.16653530300057018 0.22950236039848515 3.3853175410704064 -1.3308690401839158 -2.4306883934712609 0.058465794536544144 0.31672710450756447 1.379160724796084 -1.2898508848733117;1.1354827122340738 0.22762445937916972 -2.4251321479996553 2.8100286162466457 -1.2973119333335517 -1.1619123973561862 0.7550895622992001 1.4812798196824035 3.183831714472924 0.12862144172609624;-8.7863266784042402 -2.4634674876866152 0.091869525303443167 -5.4816401569444926 1.2796479332576152 5.7105948792189558 -1.099119486315562 -7.0608644342804947 -2.5433287280405583 -2.4546912472039248;2.2606577202390117 1.5987374800090133 -0.49353828602818145 4.6537755524128714 -3.4111374807473305 -5.7814611366574047 1.9931969337188971 5.8458107314251571 3.8790994827561414 -0.24196240961977764;2.6863944498756345 1.619656703939615 1.0745382515676705 1.3842359203924715 -3.3899468303607891 -3.168911684928843 -1.2110027329355437 -1.4570015403507981 -1.673553571404812 1.6248546598955178;2.7996976189453302 0.0619372513367785 4.7937083251932817 -2.3628912057797486 5.0841076866308512 -0.59443450439042966 -1.2481262526253014 4.4325514816560476 0.07353269457681845 2.3868798595090182;-1.7313339698117809 -0.91143124048257018 -1.2420288372304211 -4.7972813065361546 4.5530143997385526 4.8340630998427381 -1.1929146156501929 -5.5038420462508491 -6.5252445061671374 1.2732819660255428;-1.9182845196432987 -0.44263346368770551 1.3090492296998752 -3.079838354944616 2.3774931813866118 2.3189073364796418 -1.6696719282493475 0.91943278471549528 0.72010773474229595 -2.8052965074706604;0.76768294635378187 0.041173175828211582 -0.43581622901088318 -0.43192935088475276 -0.23329451255082972 1.3608194581460165 -0.44528022384860194 -5.0986538246629864 -1.4804056440808024 7.6595809996370949;1.3958470631049094 0.10863136153609941 4.5548906388830002 -1.1949615140129637 0.08862201674587751 -1.1828615601685128 -0.8114395559319052 3.6374619867130957 -0.99359943282966345 -1.0677050250242386;3.5312542254764421 1.575109041950022 -0.3350877380270661 1.7975444574265986 -2.4491351763418869 -2.9231000840930168 -0.72432988242511986 -0.33139876722716299 1.3455888566457392 1.5723892667809327;-5.503353281508355 -3.9266792588334325 -0.59890643361879459 -4.0433205180551886 2.9683329045831428 2.8068726492554634 -1.0223403988996591 -3.1433436296454946 -3.2998275211623493 1.417006600744829;0.44622753235239376 -0.43284986743157711 -0.10695224061562614 -1.0734878954290219 -0.029303942666416432 -1.9570856338931113 -0.95371186382385431 5.2089088033770903 -0.16750020766766549 -4.2548453312997347;-6.7426727505836137 -1.4133230448865843 -4.0560670732117554 -1.0349774224944182 -0.83924518655659197 2.1724656139442047 0.62627393353638006 -3.4140637371225289 0.46872269240458908 -4.3021825214660945];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
